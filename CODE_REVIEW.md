# Code Review Report

> Generated by code-review-agents (multi-agent AI review)

**Total issues found:** 24 (7 critical)

---

## Frontend Agent

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:163`
> handleDownload is an async function but errors from htmlToImage or JSZip are not caught. A failure will result in an unhandled promise rejection with no user feedback.
> 
> _Fix: Wrap the async download logic in a try/catch and surface an error state or alert to the user._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:195`
> quantity input uses parseInt without a radix and without guarding against NaN. If the field is cleared, parseInt returns NaN which propagates into the loop counter and card generation silently breaks.
> 
> _Fix: Use parseInt with radix 10 and fall back to a safe default._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:12`
> There are 14 separate useEffect hooks each writing one value to localStorage. This causes 14 independent subscriptions and storage writes on every related state change, adding unnecessary overhead and boilerplate.
> 
> _Fix: Consolidate all persistence into a single useEffect that writes all settings at once, or use a custom useLocalStorage hook._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:246`
> getPreviewCells() is called directly in the render body without useMemo. Every state change (including unrelated ones like typing in an input) recomputes the preview cells array unnecessarily.
> 
> _Fix: Memoize the preview cells derivation with useMemo._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:266`
> Cell keys in the preview grid and in generated card grids use the array index as the key. When cells are shuffled or regenerated, React cannot correctly reconcile DOM nodes, leading to potential rendering bugs.
> 
> _Fix: Use a stable key derived from the cell content and its position, or at minimum a composite of card id and index for generated cards._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:337`
> handleDownload uses document.querySelectorAll('[data-printable-card]') to find card DOM nodes. This DOM imperative approach is fragile and bypasses React's virtual DOM. If the component renders multiple instances or the DOM structure changes, this will silently capture wrong elements.
> 
> _Fix: Use a ref array attached to each card element instead of a querySelector._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:159`
> No loading state is shown during the potentially slow async image generation/zip process. Users get no feedback that the download is in progress and may click the button multiple times.
> 
> _Fix: Add an isDownloading state, disable the button while downloading, and show a spinner or label change._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:304`
> The page-level <h1> inside the control panel reads "Bingo Config" which is a developer-facing label, not a meaningful document title. The actual card heading reuses an <h2> tag. The heading hierarchy is also inconsistent (h1 â†’ h2 in preview, h3 in settings sections).
> 
> _Fix: Set a meaningful <h1> at the document level (e.g. "Bingo Card Generator") and adjust sub-headings to maintain a logical h1 > h2 > h3 hierarchy._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:382`
> Range inputs for opacity, font size, etc. have no accessible label association. The label text is a sibling element but not linked via htmlFor/id, so screen readers cannot associate them.
> 
> _Fix: Add matching id attributes to range inputs and htmlFor to their labels._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:391`
> The file input for background image upload has no accessible label associated with it via htmlFor. The label element above it wraps text but not the input.
> 
> _Fix: Add an id to the file input and a matching htmlFor on the label, or wrap the input inside the label element._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:450`
> The color input has no accessible label association (no htmlFor/id pairing). Screen readers will announce it without context.
> 
> _Fix: Add matching id and htmlFor._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:29`
> bgImage is stored as a base64 data URL in localStorage. Large images can be several megabytes, easily exceeding the ~5MB localStorage limit. The code catches the error and warns, but the image is still lost silently from the user's perspective.
> 
> _Fix: Consider storing the image in IndexedDB (e.g. via idb-keyval) for large binary data, or warn the user explicitly in the UI rather than only in the console._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:190`
> Clicking the 'Remove Image' button does not reset the file input value. If the user removes the image and then tries to re-upload the same file, the onChange event will not fire because the input's value hasn't changed.
> 
> _Fix: Use a ref on the file input and reset its value when the image is removed._

## Backend Agent

No issues found.

## Qa Agent

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx`
> Zero test coverage: No test files exist for BingoGenerator or App. The entire application logic is untested.
> 
> _Fix: Create a test file covering rendering, state changes, and core logic._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:121`
> shuffle() is an internal unexported function with no tests. Fisher-Yates correctness, immutability (original array not mutated), and distribution are not verified.
> 
> _Fix: Extract shuffle to a separate utility file and test it independently._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:131`
> handleGenerate() has no tests for the validation path (fewer than required terms), the free space insertion logic, or the quantity loop producing correct card counts.
> 
> _Fix: Test all branches of handleGenerate including insufficient terms, free space on/off, and correct quantity._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:154`
> handleDownload() uses document.querySelectorAll and htmlToImage, JSZip â€” async side effects with no tests. Failures (e.g., empty card list, htmlToImage throwing) are silently ignored.
> 
> _Fix: Mock html-to-image and JSZip, test single-card download path, multi-card ZIP path, and the no-cards early-return path._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:37`
> localStorage is read during useState initializers but is never mocked in tests, causing test pollution and cross-test state leakage.
> 
> _Fix: Use beforeEach(() => localStorage.clear()) and consider a localStorage mock to isolate each test._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:174`
> getPreviewCells() has no tests. Edge cases like exactly 24 terms, exactly 25 terms, 0 terms, and the '...' padding behaviour are unverified.
> 
> _Fix: Extract to a testable utility and add unit tests for boundary conditions._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:37`
> localStorage persistence effects have no tests. It's not verified that values are saved on change or restored on mount.
> 
> _Fix: Test that changes to inputs trigger localStorage.setItem with the correct key/value pairs._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:100`
> handleImageUpload uses FileReader with an async onloadend callback. No tests verify the file is read and state is set, or that non-image files or empty file input are handled.
> 
> _Fix: Mock FileReader and test that setBgImage is called with the correct data URL._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:148`
> handlePrint calls window.print() with no guard or test. If window.print is unavailable (SSR/test env) it will throw; no test verifies the print button triggers it.
> 
> _Fix: Mock window.print in tests and assert it is called._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:43`
> bgOpacity localStorage try/catch swallows quota exceeded errors with only a console.warn. No test covers the failure path where localStorage.setItem throws.
> 
> _Fix: Test that when localStorage.setItem throws (quota exceeded), a warning is logged and the application does not crash._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:244`
> quantity input accepts values but parseInt on non-numeric input (e.g., empty string or 'abc') returns NaN, which is passed to setQuantity and the generation loop without validation.
> 
> _Fix: Add a test for NaN/invalid quantity input and add input validation._
