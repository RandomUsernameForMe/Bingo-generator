# Code Review Report

> Generated by code-review-agents (multi-agent AI review)

**Total issues found:** 28 (7 critical)

---

## Frontend Agent

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:153`
> handleDownload is async but errors are not caught. If htmlToImage or JSZip fails, the promise rejects silently and the user gets no feedback. Also, the zip path mixes async/await with .then(), creating a potential unhandled rejection.
> 
> _Fix: Wrap the entire handleDownload body in try/catch and use consistent async/await throughout._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:37`
> Large base64 background images are stored in localStorage without size validation before the read path. The try/catch only covers the write. On initial load, localStorage.getItem('bingo-bgImage') could return a multi-MB string, blocking the main thread synchronously inside the useState initializer.
> 
> _Fix: Add a size guard when reading from localStorage and clear oversized entries._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:46`
> There are 13 separate useEffect hooks each writing one key to localStorage on every relevant state change. This causes up to 13 individual synchronous localStorage.setItem calls per render cycle and makes the code verbose. A single consolidated effect is cleaner and more performant.
> 
> _Fix: Combine all persistence side-effects into one useEffect with all relevant state values as dependencies._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:191`
> quantity input parsed with parseInt(e.target.value) without a radix and without NaN guard. If the field is cleared, parseInt returns NaN, which is passed to setQuantity and stored as state, causing the generate loop to run 0 times silently.
> 
> _Fix: Use radix 10 and clamp to a valid number._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:222`
> getPreviewCells() is called inline in JSX on every render and re-computes the cell list from rawText even when nothing relevant changed. This is cheap for small lists but wasteful in principle; it should be memoized.
> 
> _Fix: Replace the function with useMemo._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:325`
> Generated card cells use cellIndex as the key inside card.cells.map(). Cell order changes on regeneration, so reusing index as key is semantically incorrect and may cause React to reuse stale DOM nodes.
> 
> _Fix: Use a stable composite key combining card id and cell index, or use the cell text with index as a fallback._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:245`
> Preview cells also use array index as key, same issue as above.
> 
> _Fix: Use a composite key of value + index to reduce key collisions on regeneration._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:151`
> handleDownload uses document.querySelectorAll('[data-printable-card]') which is a global DOM query. If this component is ever rendered multiple times or inside a portal, it will capture cards from unintended instances. A ref to the printable container is safer.
> 
> _Fix: Attach a ref to the printable cards container and query within it._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:259`
> Download button has no loading state. htmlToImage.toPng on multiple cards can take several seconds. The button remains clickable, allowing duplicate downloads if clicked again during processing.
> 
> _Fix: Add an isDownloading state and disable/label the button while the operation is in progress._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:209`
> File input for background image upload has no accessible label association via htmlFor/id. Screen readers cannot announce the purpose of this input via the visible label.
> 
> _Fix: Add an id to the input and htmlFor to the label._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:170`
> Range inputs for bgOpacity, titleSize, subtitleSize, and cellOpacity have no accessible labels associated via htmlFor/id, only adjacent text nodes. Screen readers may not announce the current value or purpose.
> 
> _Fix: Add id attributes to range inputs and htmlFor to their labels; also add aria-valuetext for the percentage display._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:281`
> The printable card container div uses a non-standard boolean data attribute `data-printable-card` without a value. While this works in querySelectorAll, it is not valid HTML5. Use `data-printable-card="true"` for correctness.
> 
> _Fix: Assign an explicit string value to the data attribute._

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:10`
> BingoGenerator is a single monolithic component (~350+ lines) handling state, persistence, generation logic, preview, and printable output. This makes it hard to test and reason about. It should be split into smaller components (e.g., SettingsPanel, CardPreview, PrintableCard) and a custom hook (useBingoSettings) for state/persistence.
> 
> _Fix: Extract a useBingoSettings custom hook for all state and localStorage logic, and split the JSX into focused sub-components._

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:133`
> handleGenerate uses alert() for validation errors which is a blocking, inaccessible UI pattern. It cannot be styled, does not work in some environments (e.g., sandboxed iframes), and is jarring UX.
> 
> _Fix: Replace alert() with inline error state rendered in the UI._

## Backend Agent

No issues found.

## Qa Agent

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx`
> No test files exist for any component. The entire application has zero test coverage.
> 
> _Fix: Create test files for BingoGenerator.tsx covering rendering, state changes, and core logic._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:110`
> The shuffle() function is untested. Fisher-Yates correctness (no duplicates, all elements present, length preserved) is a critical invariant for card generation fairness.
> 
> _Fix: Export and unit-test the shuffle function independently._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:123`
> handleGenerate() validation logic (requiring 24 or 25 terms depending on useFreeSpace) is untested. Incorrect term counts should surface an alert but this is never verified.
> 
> _Fix: Test the validation branch that calls alert() when there are insufficient terms._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:123`
> handleGenerate() free-space branch: when useFreeSpace=true the center cell (index 12) must be 'FREE SPACE'. When false all 25 cells must be regular terms. This invariant is never tested.
> 
> _Fix: Test card generation with and without the free space option._

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:149`
> handleDownload() calls htmlToImage and JSZip APIs without any mocking or test coverage. Failures in async image export are silently swallowed.
> 
> _Fix: Mock html-to-image and JSZip, then test both the single-image and multi-image zip paths._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:44`
> localStorage is read and written throughout the component with no test isolation. Tests that run in sequence can bleed state through the real localStorage object.
> 
> _Fix: Mock localStorage in a beforeEach/afterEach block for all BingoGenerator tests._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:87`
> The localStorage.setItem for bgImage silently swallows QuotaExceededError with only a console.warn. There is no user-facing error message and the failure path has no test coverage.
> 
> _Fix: Test that the QuotaExceededError path shows a user-visible warning and does not crash._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:175`
> getPreviewCells() pads with '...' when fewer than 24/25 terms exist, but there is no test verifying the preview correctly reflects both the padded and the populated states.
> 
> _Fix: Unit-test getPreviewCells() for both the full-list and sparse-list cases._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:200`
> quantity input allows values 1â€“100 in the HTML but parseInt(e.target.value) with NaN (cleared field) is never guarded, causing NaN to be stored as the quantity and silently breaking generation.
> 
> _Fix: Test the NaN/empty quantity edge case and guard against it._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:155`
> handleDownload() for multiple cards uses .then() chained on zip.generateAsync() instead of await, mixing async/await and promise chains inconsistently. If zip.generateAsync rejects, the error is unhandled.
> 
> _Fix: Await zip.generateAsync and add error handling; test the rejection path._

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:123`
> handleGenerate() uses Date.now() + i as the card id, which is non-deterministic. Tests relying on rendered keys will be flaky without mocking Date.now().
> 
> _Fix: Mock Date.now() in tests or use a stable id strategy._

ðŸ”µ **SUGGESTION** `src/App.tsx`
> App.tsx has no smoke/render test. A trivial mounting test would catch import errors and broken default exports early.
> 
> _Fix: Add a basic render test for App._

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx`
> No integration test verifies the full user flow: enter terms â†’ set quantity â†’ click Generate â†’ click Download. End-to-end correctness of the interaction chain is untested.
> 
> _Fix: Add an integration test covering the happy path from input to card generation._

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx`
> There are no accessibility tests (e.g., with jest-axe) to verify the control panel and generated cards meet a11y standards.
> 
> _Fix: Add an axe accessibility test._
