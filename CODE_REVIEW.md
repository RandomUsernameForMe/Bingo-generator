# Code Review Report

> Generated by code-review-agents (multi-agent AI review)

**Total issues found:** 38 (10 critical)

---

## Frontend Agent

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:227`
> alert() used for validation feedback â€” blocks UI thread, inaccessible to screen readers, and poor UX
> 
> _Fix: Replace alert() with an inline error state rendered in the UI: add a useState<string | null>('') for errorMsg and render a <p role='alert' aria-live='assertive'> near the Generate button_

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:248`
> handleDownload is async but has no loading state or error handling. If htmlToImage or JSZip throws, the user gets no feedback and the UI appears frozen during long exports
> 
> _Fix: Add an isDownloading state, disable the button and show a spinner while downloading, and wrap the entire function body in try/catch with a visible error message on failure_

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:200`
> Background image is stored as a base64 Data URL in localStorage. Large images will exceed the ~5MB localStorage quota and silently fail (the catch only warns in the console), potentially corrupting other stored keys
> 
> _Fix: Use IndexedDB (via idb-keyval or similar) for binary/large data storage, or store only a reference and keep the image in memory. Inform the user in the UI if storage fails_

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:316`
> Preview grid uses array index as key (`key={i}`) on cells that are re-generated on every render of getPreviewCells(). This causes incorrect reconciliation when the cell list changes
> 
> _Fix: Use a stable key derived from the cell content, e.g. `key={\`${cell}-${i}\`}`, or better, memoize the preview cells with useMemo and derive a content-based key_

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:388`
> Printable card cells also use array index as key (`key={cellIndex}`). Same reconciliation issue and additionally every card re-renders all cells on any state change
> 
> _Fix: Use `key={\`${card.id}-${cellIndex}\`}` or a content hash. Wrap the printable card in React.memo to prevent re-renders when unrelated state changes_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:14`
> 13 separate useEffect hooks each write one value to localStorage on every change. This triggers 13 separate synchronous localStorage writes on any state change, blocking the main thread
> 
> _Fix: Consolidate all persistence into a single useEffect that depends on all relevant state values and writes them in one pass, or debounce writes using a custom hook_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:277`
> getPreviewCells() is a plain function called during render, re-running the full split/filter/slice/splice on every render cycle regardless of whether rawText or useFreeSpace changed
> 
> _Fix: Wrap with useMemo: `const previewCells = useMemo(() => { ... }, [rawText, useFreeSpace])`_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:173`
> shuffle() and handleGenerate() are recreated on every render. shuffle is a pure utility that doesn't need to be inside the component
> 
> _Fix: Move shuffle outside the component as a module-level function. Wrap handleGenerate in useCallback with appropriate dependencies_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:295`
> Two <h2> elements exist at the same level in the component tree (Live Preview heading and the card title inside the preview), causing incorrect heading hierarchy
> 
> _Fix: Change the card title inside the preview to a <p> or <div> styled as a heading, since it is a data display element not a document section heading. The 'Live Preview' label should be h2, the config panel title should be h1_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:163`
> quantity input uses parseInt(e.target.value) without a fallback; if the input is cleared or contains NaN (e.g. user types a letter), quantity becomes NaN, breaking handleGenerate's loop silently
> 
> _Fix: Use `const val = parseInt(e.target.value, 10); if (!isNaN(val)) setQuantity(val);` and add an `onBlur` to clamp the value between 1 and 100_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:248`
> In the multi-card download path, URL.createObjectURL(content) is called but URL.revokeObjectURL() is never called, causing a memory leak for each ZIP download
> 
> _Fix: Call URL.revokeObjectURL(link.href) after link.click(), or use a setTimeout to revoke after a short delay_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:141`
> File input for image upload has no accessible label associated via htmlFor/id. The visible label text 'Background Image (Optional)' is not programmatically linked to the input
> 
> _Fix: Add `id='bg-image-upload'` to the input and `htmlFor='bg-image-upload'` to the label element, or wrap both in a single <label>_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:109`
> Range inputs for titleSize, subtitleSize, bgOpacity, and cellOpacity have no accessible labels linked via htmlFor/id. The label text is adjacent but not programmatically associated
> 
> _Fix: Add matching id attributes to each range input and htmlFor to each label, e.g. `id='title-size-range'` / `htmlFor='title-size-range'`_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:217`
> The color picker input has no accessible label linked via htmlFor/id
> 
> _Fix: Add `id='text-color-picker'` to the input and `htmlFor='text-color-picker'` to the label_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:337`
> The printable card area is always rendered in the DOM (even when generatedCards is empty it renders an empty container), and the printable cards are always visible on screen, just pushed below the fold
> 
> _Fix: Conditionally render the printable area only when generatedCards.length > 0, or apply `print:block hidden` to hide it from screen view and only show on print_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:1`
> BingoGenerator is a single 400+ line component handling state management, persistence, generation logic, preview rendering, and printable output. This violates single-responsibility and makes testing/maintenance difficult
> 
> _Fix: Split into: useLocalStorage custom hook, useBingoGenerator logic hook, BingoSettingsPanel, BingoPreviewCard, BingoPrintableCard, and BingoGenerator as the orchestrating parent_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:304`
> The preview card uses hardcoded `text-[0.5rem]` for cell text, which may be unreadable on smaller screens and doesn't scale with font size settings
> 
> _Fix: Use a relative unit or container queries. Consider using the CSS `font-size: clamp()` approach or applying a CSS class that scales with the grid container size_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:230`
> handleGenerate does not clear previously generated cards if validation fails, which could cause confusion (old cards remain visible after changing settings without re-generating)
> 
> _Fix: Call setGeneratedCards([]) at the start of handleGenerate, before validation, so the output always reflects the current action_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:354`
> Printable cards use fixed mm units (210mm Ã— 297mm) hardcoded for A4. Users printing on US Letter will get clipped output
> 
> _Fix: Add a page size selector (A4 / US Letter / Custom) and map to appropriate dimensions, or use CSS @page media query to handle it declaratively_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:236`
> The random card generation uses Date.now() + i as card IDs. In fast loops, Date.now() may return the same value for multiple cards on fast hardware, risking duplicate IDs
> 
> _Fix: Use a counter ref or crypto.randomUUID() for unique IDs: `const idRef = useRef(0); id: idRef.current++`_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:340`
> Download and Print buttons use emoji as the only visual icon indicator. These may render inconsistently across operating systems and are not accessible to screen readers as meaningful icons
> 
> _Fix: Use an SVG icon library (e.g. lucide-react, heroicons) with aria-hidden='true' on the icon and keep descriptive button text, or add aria-label to the button_

ðŸ”µ **SUGGESTION** `src/main.tsx:7`
> document.getElementById('root')! uses a non-null assertion without a guard. If the root element is missing (e.g. wrong HTML template), this throws a cryptic runtime error
> 
> _Fix: Add a null check: `const rootEl = document.getElementById('root'); if (!rootEl) throw new Error('Root element #root not found'); ReactDOM.createRoot(rootEl).render(...)`_

## Backend Agent

No issues found.

## Qa Agent

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx`
> Zero test coverage: No test files exist for BingoGenerator or App components
> 
> _Fix: Create src/BingoGenerator.test.tsx covering core behaviors: rendering, card generation, free space toggling, shuffle output, and export actions_

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:126`
> handleGenerate has no tests for the validation branch (fewer than required terms) and the alert side-effect is untested
> 
> _Fix: Write unit tests asserting that alert() is called when terms.length < requiredTerms, and that setGeneratedCards is NOT called in that case. Use vi.spyOn(window, 'alert') to capture the call_

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:152`
> handleDownload is completely untested: both the single-card and multi-card (ZIP) branches, as well as the htmlToImage and JSZip integrations
> 
> _Fix: Mock html-to-image and jszip in tests. Write separate test cases for length===1 (direct PNG download) and length>1 (ZIP generation), verifying link.click() and correct file names_

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:50`
> All localStorage interactions are untested â€” initial state hydration from localStorage and all persistence useEffect hooks
> 
> _Fix: Before each test, use vi.stubGlobal or jest-localstorage-mock to preset values and assert that state is initialized correctly; also assert setItem/removeItem are called after state changes_

ðŸ”´ **CRITICAL** `src/BingoGenerator.tsx:78`
> localStorage.setItem for bgImage can throw a QuotaExceededError; the catch branch only logs a warning and is untested
> 
> _Fix: Test the catch branch by mocking localStorage.setItem to throw a QuotaExceededError when called with 'bingo-bgImage', and assert the console.warn is invoked without re-throwing_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:108`
> shuffle() function is not independently unit-tested; its Fisher-Yates correctness, handling of empty arrays, and single-element arrays are unverified
> 
> _Fix: Extract shuffle to a separate utility file (src/utils/shuffle.ts) and write unit tests for: empty array, single element, full 25-element array (assert same elements, different order distribution)_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:119`
> handleGenerate with useFreeSpace=true vs false produces different cell counts and FREE SPACE placement, but neither variant is tested
> 
> _Fix: Write tests for both useFreeSpace=true (expects 25 cells, index 12 === 'FREE SPACE') and useFreeSpace=false (expects 25 cells, no 'FREE SPACE'), asserting cells array shape_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:175`
> getPreviewCells() pads with '...' when fewer than required terms are available, but this padding logic is untested
> 
> _Fix: Test getPreviewCells() with 0 terms, exactly 24 terms, and >24 terms for both useFreeSpace states, asserting correct length and '...' padding presence_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:95`
> handleImageUpload reads a File via FileReader but has no tests verifying the async onloadend callback sets bgImage state
> 
> _Fix: Use a fake File object and mock FileReader (or use userEvent.upload) in a test; assert that setBgImage is called with the expected data URL result_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:143`
> handlePrint calls window.print() with no guard or test; failure modes (no cards generated) are unverified
> 
> _Fix: Spy on window.print with vi.spyOn; assert it is called exactly once when the Print button is clicked, and is NOT called before cards are generated_

ðŸŸ¡ **WARNING** `src/BingoGenerator.tsx:31`
> quantity input has no validation test for out-of-range values (e.g., 0, negative, >100, non-integer NaN from parseInt)
> 
> _Fix: Test that entering 0 or a non-numeric value does not generate cards, and assert parseInt edge cases (empty string â†’ NaN) are gracefully handled_

ðŸŸ¡ **WARNING** `src/App.tsx`
> App component has no smoke test verifying it renders BingoGenerator without crashing
> 
> _Fix: Add src/App.test.tsx with a single render test: render(<App />) and assert a known element (e.g., 'Bingo Config' heading) is present in the document_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx`
> No integration test covering the full user workflow: enter terms â†’ click Generate â†’ verify card count and cell structure â†’ click Download
> 
> _Fix: Write an integration test using React Testing Library that simulates entering 25 terms, clicking Generate Cards, asserting 1 card renders with 25 cells, and that the download button appears_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx`
> No snapshot or visual regression tests for the rendered bingo card layout (printable area)
> 
> _Fix: Add a snapshot test for the printable card with a fixed seed/mock for Math.random, ensuring grid structure, FREE SPACE position, and style attributes remain stable across refactors_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx:119`
> Math.random is called inside handleGenerate/shuffle with no way to control randomness in tests, making card content assertions non-deterministic
> 
> _Fix: Inject a seeded random function or mock Math.random with vi.spyOn(Math, 'random').mockReturnValue(0.5) in tests to make shuffle output deterministic and assertable_

ðŸ”µ **SUGGESTION** `src/BingoGenerator.tsx`
> No accessibility tests (ARIA roles, keyboard navigation, label associations) for form controls
> 
> _Fix: Use jest-axe or @testing-library/jest-dom to run axe accessibility checks on the rendered component and assert zero violations_
